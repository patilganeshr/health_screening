var SharpiTech={};SharpiTech.PurchaseBillRegister=function(){function u(){n.loader=document.getElementById("Loader");n.printPurchaseBillRegister=document.getElementById("PrintPurchaseBillRegister");n.exportPurchaseBillRegister=document.getElementById("ExportPurchaseBillRegister");n.reportByFinancialYear=document.getElementById("ReportByFinancialYear");n.reportByVendor=document.getElementById("ReportByVendor");n.reportByFromToDate=document.getElementById("ReportByFromToDate");n.reportByFinancialYearAndVendor=document.getElementById("ReportByFinancialYearAndVendor");n.repotByVendorAndFromToDate=document.getElementById("RepotByVendorAndFromToDate");n.financialYear=document.getElementById("FinancialYear");n.vendor=document.getElementById("Vendor");n.fromDate=document.getElementById("FromDate");n.fromDatePicker=document.getElementById("FromDatePicker");n.toDate=document.getElementById("ToDate");n.toDatePicker=document.getElementById("ToDatePicker");n.$fromDatePicker=$("#FromDatePicker");n.$toDatePicker=$("#ToDatePicker");n.purchaseBillsRegisterList=document.getElementById("PurchaseBillRegisterList")}function e(){$("select").select2();var t=new Date;n.$fromDatePicker.datetimepicker({format:"DD/MMM/YYYY",defaultDate:moment(t).format("DD/MMM/YYYY")})}function o(){n.printPurchaseBillRegister.addEventListener("click",c);n.exportPurchaseBillRegister.addEventListener("click",l);n.reportByFinancialYear.addEventListener("oncheck",r);n.reportByVendor.addEventListener("oncheck",r)}function r(){n.reportByFinancialYear.checked?(n.financialYear.disabled=!1,n.vendor.disabled=!0):n.reportByVendor.checked&&(n.vendor.disabled=!1,n.financialYear.disabled=!0)}function s(){}function h(){var u,t,r;if(i.length>0&&(u=n.purchaseBillsRegisterList.tBodies[0],u.innerHTML="",i.length)){for(t="",r=0;r<stockDetails.length;r++)t=t+"<tr>",t=t+"<td>"+stockDetails[r].ItemName+"<\/td>",t=t+"<td>"+stockDetails[r].ItemQuality+"<\/td>",t=t+"<td>"+stockDetails[r].BrandName+"<\/td>",t=t+"<td>"+stockDetails[r].ItemCategoryName+"<\/td>",t=t+"<td>"+stockDetails[r].VendorName+"<\/td>",t=t+"<td>"+stockDetails[r].QtyInPcs+"<\/td>",t=t+"<td>"+stockDetails[r].QtyInMtrs+"<\/td>",t=t+"<td>"+stockDetails[r].LocationName+"<\/td>",t=t+"<td>"+stockDetails[r].CategoryA+"<\/td>",t=t+"<td>"+stockDetails[r].CategoryC+"<\/td>",t=t+"<\/tr>";u.innerHTML=t}}function c(){}function l(){a()}function a(){var t="<table border='2px'><tr bgcolor='#87AFC6'>",i=0,r,u;for(tab=n.stockReport,i=0;i<tab.rows.length;i++)t=t+tab.rows[i].innerHTML+"<\/tr>";return t=t+"<\/table>",t=t.replace(/<A[^>]*>|<\/A>/g,""),t=t.replace(/<img[^>]*>/gi,""),t=t.replace(/<input[^>]*>|<\/input>/gi,""),r=window.navigator.userAgent,u=r.indexOf("MSIE "),u>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)?(txtArea1.document.open("txt/html","replace"),txtArea1.document.write(t),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,"Test.xls")):sa=window.open("data:application/vnd.ms-excel,"+encodeURIComponent(t)),sa}function v(){u();e();o();s()}var n={},t=new Shared,i=[];return{init:v}}();SharpiTech.PurchaseBillRegister.init();